locations:
  theRoom:
    name: A Room
    description: |
      You are in a small room with a door to the north.
    caches:
      floor:
        objects:
          theKey:
            name: a key
            description: an ordinary brass key.
start_scene: theRoom
character:
  stats:
    intelligence: 100
  inventory:
    commodities:
      money: 17
scenes:
  theHint:
    description: |
      You should pick up the key.
    menu:
      GoBack:
        description: Try it out.
        next_scene: theRoom
  theRoom:
    location: theRoom
    description: |
      # You Are In {{ location.name }}
      
      {{ location.description }}

      You have {{character.inventory.commodities.money}} monies.

      {%- for id, item in caches.floor.objects %}
      {%- if loop.first %}

      On the floor, there is 
      {%- elif loop.last %}, and
      {%- else %},
      {%- endif %} {{ item.description }}
      {%- endfor %}.
    menu:
      GetHint:
        test:
          commodity_greater:
            - money
            - 5
        description: Get a hint for five moneys.
        actions:
          - !UseCommodity
            - money
            - 5
        next_scene: theHint
      TryLockedDoor:
        test: 
          not:
            inventory_contains: theKey
        description: Try the door.
        actions:
          - !AddStat
            - intelligence
            - -10
        next_scene: theRoom
      TryUnlockedDoor:
        test: 
          inventory_contains: theKey
        description: Try the door.
        actions:
          - !AddAchievement unlockedDoor
        next_scene: winnningRoom
      PickUpKey:
        test: 
          not:
            inventory_contains: theKey
        description: Pick up the key.
        next_scene: theRoom
        actions:
          - !TakeObject ["theRoom", "floor", "theKey"]
  winnningRoom:
    description: |
      {% if character.achievements is containing("unlockedDoor") %}You unlock the door.{% endif %}

      You have won the game
      {%- if character.stats.intelligence > 70 %}!
      {%- else %}... barely.
      {%- endif %}
    menu: 
      Quit:
        description: Quit the game.
        actions:
          - !Win
          - !Quit
        next_scene: winnningRoom

